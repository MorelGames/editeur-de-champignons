(function(e){function t(t){for(var n,r,a=t[0],c=t[1],u=t[2],p=0,d=[];p<a.length;p++)r=a[p],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&d.push(s[r][0]),s[r]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);l&&l(t);while(d.length)d.shift()();return o.push.apply(o,u||[]),i()}function i(){for(var e,t=0;t<o.length;t++){for(var i=o[t],n=!0,a=1;a<i.length;a++){var c=i[a];0!==s[c]&&(n=!1)}n&&(o.splice(t--,1),e=r(r.s=i[0]))}return e}var n={},s={app:0},o=[];function r(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=n,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/editeur-de-champignons/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var u=0;u<a.length;u++)t(a[u]);var l=c;o.push([0,"chunk-vendors"]),i()})({0:function(e,t,i){e.exports=i("56d7")},"0fcd":function(e,t,i){"use strict";i("e5ea")},"2b7e":function(e,t,i){},3861:function(e,t,i){"use strict";i("3a26")},"3a26":function(e,t,i){},"56d7":function(e,t,i){"use strict";i.r(t);i("e260"),i("e6cf"),i("cca6"),i("a79d"),i("d3b7"),i("159b");var n=i("2b0e"),s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"app"}},[i("Header"),i("main",{class:{"has-question":e.is_question_displayed}},[i("QuestionsList"),i("QuestionDetails")],1),i("ValidationModal"),i("ImportModal")],1)},o=[],r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("header",{staticClass:"header"},[e.is_question_displayed?i("b-button",{attrs:{"icon-left":"arrow-left",type:"is-link","aria-label":"Retour"},on:{click:e.unselectQuestion}}):e._e(),e._m(0),i("aside",[i("b-switch",{model:{value:e.preview,callback:function(t){e.preview=t},expression:"preview"}},[i("span",[e._v("Prévisualisation")]),i("b-icon",{attrs:{icon:"language-markdown"}})],1),i("b-dropdown",{attrs:{"aria-role":"list",position:"is-bottom-left"},scopedSlots:e._u([{key:"trigger",fn:function(e){var t=e.active;return[i("b-button",{attrs:{label:"Menu",type:"is-primary",size:"is-small",rounded:"","icon-right":t?"menu-up":"menu-down"}})]}}])},[i("b-dropdown-item",{attrs:{"aria-role":"listitem"},on:{click:function(t){return e.importing(!0)}}},[i("div",{staticClass:"media"},[i("b-icon",{staticClass:"media-left",attrs:{icon:"application-import"}}),i("div",{staticClass:"media-content"},[i("h3",[e._v("Importer")]),i("small",[e._v("Importer des questions depuis un fichier JSON Shroom")])])],1)]),i("b-dropdown-item",{attrs:{"aria-role":"listitem"},on:{click:e.exportQuestions}},[i("div",{staticClass:"media"},[i("b-icon",{staticClass:"media-left",attrs:{icon:"application-export"}}),i("div",{staticClass:"media-content"},[i("h3",[e._v("Exporter")]),i("small",[e._v("Exporter les questions en JSON compatible avec Shroom")])])],1)]),i("hr",{staticClass:"dropdown-divider"}),i("b-dropdown-item",{attrs:{"aria-role":"listitem"},on:{click:function(t){return e.previewSourceURLs(null)}}},[i("div",{staticClass:"media"},[i("b-icon",{staticClass:"media-left",attrs:{icon:"flash-red-eye"}}),i("div",{staticClass:"media-content"},[i("h3",[e._v("Développer les URLs dans les sources")]),i("small",[e._v("Remplace les URLs brutes par des liens avec le titre de la page")])])],1)]),i("b-dropdown-item",{attrs:{"aria-role":"listitem"},on:{click:function(t){return e.toggleAnswersVisible()}}},[i("div",{staticClass:"media"},[e.answers?i("b-icon",{staticClass:"media-left",attrs:{icon:"eye"}}):i("b-icon",{staticClass:"media-left",attrs:{icon:"eye-off"}}),i("div",{staticClass:"media-content"},[e.answers?i("h3",[e._v("Masquer les réponses")]):i("h3",[e._v("Afficher les réponses")]),i("small",[e._v("Masquez les réponses pour tester les questions…")])])],1)])],1)],1)],1)},a=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("h1",[i("span",[e._v("Éditeur de questions ⋅ ")]),e._v("Shroom")])}],c=i("5530"),u=i("2f62"),l={computed:Object(c["a"])(Object(c["a"])(Object(c["a"])({},Object(u["d"])(["answers"])),Object(u["d"])({is_question_displayed:function(e){return!!e.current}})),{},{preview:{get:function(){return this.$store.state.preview},set:function(e){this.togglePreview(e)}}}),methods:Object(c["a"])(Object(c["a"])({},Object(u["c"])(["togglePreview","toggleAnswersVisible","unselectQuestion","importing"])),Object(u["b"])(["exportQuestions","previewSourceURLs"]))},p=l,d=(i("94ab"),i("2877")),m=Object(d["a"])(p,r,a,!1,null,null,null),f=m.exports,v=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("article",{staticClass:"question-editor"},[e.current_uuid?[i("div",{staticClass:"level-single"},[i("b-dropdown",{attrs:{"aria-role":"list"},on:{input:e.update},scopedSlots:e._u(["text"===e.question.answer.type?{key:"trigger",fn:function(){return[i("b-button",{attrs:{label:"Texte",type:"is-primary","icon-left":"lead-pencil","icon-right":"menu-down",size:"is-medium"}})]},proxy:!0}:"qcm"===e.question.answer.type?{key:"trigger",fn:function(){return[i("b-button",{attrs:{label:"QCM",type:"is-primary","icon-left":"format-list-bulleted-square","icon-right":"menu-down",size:"is-medium"}})]},proxy:!0}:"geo"===e.question.answer.type?{key:"trigger",fn:function(){return[i("b-button",{attrs:{label:"Carte",type:"is-primary","icon-left":"map","icon-right":"menu-down",size:"is-medium"}})]},proxy:!0}:"drawing"===e.question.answer.type?{key:"trigger",fn:function(){return[i("b-button",{attrs:{label:"Dessin",type:"is-primary","icon-left":"draw","icon-right":"menu-down",size:"is-medium"}})]},proxy:!0}:{key:"trigger",fn:function(){return[i("b-button",{attrs:{label:e.question.answer.type,type:"is-primary","icon-left":"crosshairs-question","icon-right":"menu-down",size:"is-medium"}})]},proxy:!0}],null,!0),model:{value:e.question.answer.type,callback:function(t){e.$set(e.question.answer,"type",t)},expression:"question.answer.type"}},[i("b-dropdown-item",{attrs:{value:"text","aria-role":"listitem"}},[i("div",{staticClass:"media"},[i("b-icon",{staticClass:"media-left",attrs:{icon:"lead-pencil"}}),i("div",{staticClass:"media-content"},[i("h3",[e._v("Texte")]),i("small",[e._v("La réponse doit être écrite directement.")])])],1)]),i("b-dropdown-item",{attrs:{value:"qcm","aria-role":"listitem"}},[i("div",{staticClass:"media"},[i("b-icon",{staticClass:"media-left",attrs:{icon:"format-list-bulleted-square"}}),i("div",{staticClass:"media-content"},[i("h3",[e._v("QCM")]),i("small",[e._v(" La ou les réponses sont choisies parmi une liste de propositions."),i("br"),e._v(" Ce type de question peut également être posée sans les propositions, aléatoirement. ")])])],1)]),i("b-dropdown-item",{attrs:{value:"geo","aria-role":"listitem"}},[i("div",{staticClass:"media"},[i("b-icon",{staticClass:"media-left",attrs:{icon:"map"}}),i("div",{staticClass:"media-content"},[i("h3",[e._v("Carte")]),i("small",[e._v("La réponse doit être sélectionnée sur une carte.")])])],1)]),i("b-dropdown-item",{attrs:{value:"drawing","aria-role":"listitem"}},[i("div",{staticClass:"media"},[i("b-icon",{staticClass:"media-left",attrs:{icon:"draw"}}),i("div",{staticClass:"media-content"},[i("h3",[e._v("Dessin")]),i("small",[e._v(" La réponse doit être dessinée."),i("br"),e._v(" Des outils de dessin simples (couleur, taille de brosse, remplissage, etc.) sont proposés. ")])])],1)])],1),e.preview?i("p",{staticClass:"question-preview is-size-4 is-family-display",domProps:{innerHTML:e._s(e.mdInline(e.question.question.text))}}):i("b-input",{ref:"questionInput",staticClass:"is-display",attrs:{type:"text",placeholder:"Écrivez la question ici…",size:"is-medium","icon-right":"language-markdown",spellcheck:"true"},on:{input:e.update},model:{value:e.question.question.text,callback:function(t){e.$set(e.question.question,"text",t)},expression:"question.question.text"}}),i("a",{on:{click:e.deleteQuestionConfirmation}},[i("b-icon",{attrs:{icon:"delete",size:"is-medium"}})],1)],1),i("div",{staticClass:"columns"},[i("div",{staticClass:"column is-half"},[i("section",{staticClass:"section"},[e._m(0),i("QuestionContent",{attrs:{uuid:e.current_uuid,path:"question"}})],1),i("section",{staticClass:"section"},[i("div",{staticClass:"titles-with-button"},[e._m(1),i("a",{attrs:{title:"Prévisualiser automatiquement les liens"},on:{click:function(t){return e.previewSourceURLs(e.current_uuid)}}},[i("b-icon",{attrs:{icon:"flash-red-eye"}})],1)]),e.preview?i("div",{staticClass:"content",domProps:{innerHTML:e._s(e.md(e.sources))}}):i("b-field",{attrs:{message:["Chaque ligne sera affichée comme une source séparée, dans une liste. Markdown est supporté, ligne par ligne.","Les sources ne sont affichées que pendant la phase de correction, donc vous pouvez y révéler la réponse."]}},[i("b-input",{attrs:{type:"textarea","icon-right":"language-markdown",rows:"2"},model:{value:e.sources,callback:function(t){e.sources=t},expression:"sources"}})],1)],1),i("section",{staticClass:"section"},[i("b-field",{staticClass:"level-main",attrs:{label:"Catégories",message:"La première catégorie est la principale ; elle sera affichée en jeu. Les autres filtrent les questions."}},[i("b-taginput",{ref:"tagInputCategories",attrs:{autocomplete:"",data:e.known_categories_filtered,"allow-new":!0,placeholder:0===e.question.categories.length?"Nouvelle catégorie…":"Ajouter une autre catégorie…","aria-close-label":"Supprimer cette catégorie"},on:{input:e.update,typing:e.filterKnownCategories},scopedSlots:e._u([{key:"selected",fn:function(t){return e._l(t.tags,(function(t,n){return i("b-tag",{key:n,attrs:{type:0===n?"is-primary":"is-link",tabstop:!1,closable:""},on:{close:function(t){return e.$refs.tagInputCategories.removeTag(n,t)}}},[e._v(" "+e._s(t)+" ")])}))}}],null,!1,3397599791),model:{value:e.question.categories,callback:function(t){e.$set(e.question,"categories",t)},expression:"question.categories"}})],1),i("div",{staticClass:"level-single is-spaced"},[i("b-field",{attrs:{label:"Durée",message:["Temps laissé pour répondre, en secondes.","La valeur par défaut dépend du type de question."]}},[i("b-input",{attrs:{type:"number","icon-right":"alpha-s"},on:{input:e.update},model:{value:e.question.duration,callback:function(t){e.$set(e.question,"duration",t)},expression:"question.duration"}})],1),i("b-field",{attrs:{label:"Langue"}},[i("b-input",{on:{input:e.update},model:{value:e.question.lang,callback:function(t){e.$set(e.question,"lang",t)},expression:"question.lang"}})],1),i("b-field",{attrs:{label:"Public cible",message:"Les questions 18+ sont filtrables."}},[i("b-switch",{on:{input:e.update},model:{value:e.question.nsfw,callback:function(t){e.$set(e.question,"nsfw",t)},expression:"question.nsfw"}},[i("abbr",{attrs:{title:"Not Safe for Work (déconseillé aux jeunes, pour le travail, etc.)"}},[e._v("NSFW")])])],1)],1)],1)]),i("div",{staticClass:"column is-half"},[i("section",{staticClass:"section"},[i("div",{staticClass:"titles-with-button"},[e._m(2),"qcm"===e.question.answer.type?i("b-button",{attrs:{type:"is-primary",rounded:"","icon-left":"plus"},on:{click:e.addQCMOption}},[e._v(" Réponse ")]):e._e()],1),"text"===e.question.answer.type?[i("b-field",{attrs:{message:"Pour les questions textuelles, entrez le texte de la réponse. La correction sera manuelle, et sera pré-faite en normalisant la réponse pour la comparer à ce qui a été entré par les participant⋅e⋅s."}},[i("b-input",{attrs:{placeholder:"Entrez la réponse ici…"},on:{input:e.update},model:{value:e.question.answer.answer,callback:function(t){e.$set(e.question.answer,"answer",t)},expression:"question.answer.answer"}})],1)]:"qcm"===e.question.answer.type?i("div",{ref:"answerOptions"},[i("b-field",[e._v(" Indiquez toutes les propositions de réponse, et cochez la ou les bonnes réponses. L'ordre n'a pas d'importance : les réponses seront affichées mélangées. ")]),e._l(e.question.answer.options,(function(t,n){return i("b-field",{key:n,attrs:{grouped:""}},[e.answersVisible?i("b-checkbox",{on:{input:e.update},model:{value:t.valid,callback:function(i){e.$set(t,"valid",i)},expression:"option.valid"}}):e._e(),i("b-input",{attrs:{placeholder:"Entrez la réponse ici…",expanded:""},on:{input:e.update},nativeOn:{keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addQCMOption.apply(null,arguments)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"delete",[8,46],t.key,["Backspace","Delete","Del"])?null:e.deleteQCMOptionIfEmpty(n,t)}]},model:{value:t.answer,callback:function(i){e.$set(t,"answer",i)},expression:"option.answer"}}),e.question.answer.options.length>1?i("b-button",{attrs:{type:"is-ghost",title:"Supprimer"},on:{click:function(t){return e.deleteQCMOptionConfirmation(n,t)}}},[i("b-icon",{attrs:{icon:"delete"}})],1):e._e()],1)})),i("b-field",[i("b-switch",{on:{input:e.update},model:{value:e.question.answer.as_text,callback:function(t){e.$set(e.question.answer,"as_text",t)},expression:"question.answer.as_text"}},[e._v(" Proposer également cette question sans les propositions"),i("br"),i("small",[e._v(" Si activé, cette question pourra être proposée sans les réponses, tel une question textuelle. La correction utilisera la bonne réponse ci-dessous. ")])])],1)],2):"geo"===e.question.answer.type?[i("em",[e._v("Pas encore disponible")])]:"drawing"===e.question.answer.type?i("div",{staticClass:"content"},[i("p",{staticClass:"no-answer"},[e._v(" Il n'y a aucune réponse à configurer pour les questions dont la réponse est un dessin : nous n'analysons pas automatiquement les dessins pour corriger ; la réponse est faite à la main. ")]),e._m(3)]):e._e()],2),i("section",{staticClass:"section"},[e._m(4),i("QuestionContent",{attrs:{uuid:e.current_uuid,path:"answer"}})],1)])])]:i("div",{staticClass:"no-question-selected"},[i("h3",[e._v("Vous n'avez sélectionné aucune question.")]),i("p",[e._v("Choisissez-en une à droite, ou "),i("a",{on:{click:e.newQuestion}},[e._v("créez-en une nouvelle")]),e._v(".")]),i("p",{staticClass:"is-tip"},[e._v(" Quand vous aurez fini, vous pourrez exporter toutes les questions dans un fichier, en haut à droite. En attendant, tout est automatiquement sauvegardé dans votre navigateur. ")])])],2)},h=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("header",{staticClass:"titles"},[i("h3",{staticClass:"title is-5"},[e._v("Question")]),i("p",{staticClass:"subtitle is-6"},[e._v(" Contenu affiché lorsque la question est posée, pour donner du contexte supplémentaire si nécessaire. La réponse ne doit pas être donnée ici. ")])])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("header",{staticClass:"titles"},[i("h3",{staticClass:"title is-5"},[e._v("Sources")]),i("p",{staticClass:"subtitle is-6"},[e._v(" Précisez ici les sources de la question, pour permettre aux joueurs⋅euses d'approfondir le sujet. ")])])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("header",{staticClass:"titles"},[i("h3",{staticClass:"title is-5"},[e._v("Réponse")]),i("p",{staticClass:"subtitle is-6"},[e._v(" Quelle est la bonne réponse à la question ? ")])])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("p",{staticClass:"no-answer"},[i("strong",[e._v("Cependant")]),e._v(", n'oubliez pas de donner une référence de correction (par exemple, une image) dans les explications ci-dessous ! ")])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("header",{staticClass:"titles"},[i("h3",{staticClass:"title is-5"},[e._v("Explications")]),i("p",{staticClass:"subtitle is-6"},[e._v(" Quelques éléments pour donner des détails sur la réponse, afin que les joueurs quittent la partie avec un peu de culture générale en plus ! ")])])}],b=i("2909"),y=(i("6062"),i("3ca3"),i("ddb0"),i("0481"),i("4069"),i("d81d"),i("07ac"),i("a15b"),i("ac1f"),i("1276"),i("4de4"),i("a434"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("article",{staticClass:"question-content-editor"},[0===e.content.length?i("div",{staticClass:"empty"},[e._v(" Contenu vide. "),e.preview?e._e():i("span",[e._v("Vous pouvez ajouter un élément ci-dessous !")])]):e._e(),e._l(e.content,(function(t,n){return i("div",{key:n,staticClass:"question-content-item media"},[i("div",{staticClass:"media-left"},["text"===t.type?i("b-icon",{attrs:{icon:"text",size:"is-medium"}}):"quote"===t.type?i("b-icon",{attrs:{icon:"format-quote-close",size:"is-medium"}}):"picture"===t.type?i("b-icon",{attrs:{icon:"image",size:"is-medium"}}):"movie"===t.type?i("b-icon",{attrs:{icon:"movie",size:"is-medium"}}):"sound"===t.type?i("b-icon",{attrs:{icon:"headphones",size:"is-medium"}}):e._e()],1),"text"===t.type?i("div",{staticClass:"media-content"},[e.preview?i("div",{staticClass:"content",domProps:{innerHTML:e._s(e.md(t.text))}}):i("b-input",{attrs:{type:"textarea",placeholder:"Entrez le texte ici. Markdown est supporté.","icon-right":"language-markdown",rows:"5"},on:{input:e.update},model:{value:t.text,callback:function(i){e.$set(t,"text",i)},expression:"item.text"}})],1):"quote"===t.type?i("div",{staticClass:"media-content"},[e.preview?i("div",{staticClass:"content"},[i("blockquote",[i("div",{domProps:{innerHTML:e._s(e.md(t.text))}}),t.author?i("p",[e._v("— "),i("em",{domProps:{innerHTML:e._s(e.mdInline(t.author))}})]):e._e()])]):[i("b-field",[i("b-input",{attrs:{type:"textarea",placeholder:"Entrez la citation ici. Markdown est supporté.","icon-right":"language-markdown",rows:"2"},on:{input:e.update},model:{value:t.text,callback:function(i){e.$set(t,"text",i)},expression:"item.text"}})],1),i("b-field",[i("b-input",{attrs:{type:"text",placeholder:"Auteur de la citation (facultatif)",icon:"fountain-pen-tip","icon-right":"language-markdown"},on:{input:e.update},model:{value:t.author,callback:function(i){e.$set(t,"author",i)},expression:"item.author"}})],1)]],2):["picture","movie","sound"].indexOf(t.type)>=0?i("div",{staticClass:"media-content"},[e.preview?i("div",{staticClass:"content"},["picture"===t.type&&"name"===t.__selected_input_source?i("figure",[i("img",{attrs:{src:t.name,alt:t.alt}}),i("figcaption",{domProps:{innerHTML:e._s(e.mdInline(t.caption))}})]):i("p",[i("em",[e._v("Prévisualisation non supportée actuellement.")])])]):["picture"===t.type?i("div",["picture"===t.type?i("b-field",{attrs:{message:"Pour un nom de fichier, le fichier devra être placé dans un sous-dossier “assets”."}},[i("b-input",{attrs:{type:"text",placeholder:"URL ou nom du fichier de l'image",icon:"link"},on:{input:e.update},model:{value:t.name,callback:function(i){e.$set(t,"name",i)},expression:"item.name"}})],1):e._e()],1):i("div",{staticClass:"field"},[i("b-field",[i("b-select",{model:{value:t.__selected_input_source,callback:function(i){e.$set(t,"__selected_input_source",i)},expression:"item.__selected_input_source"}},e._l(e.itemInputTypes(t.type),(function(t){return i("option",{key:t[0],domProps:{value:t[0]}},[e._v(e._s(t[1]))])})),0),i("b-input",{attrs:{type:"text",placeholder:e.itemInputType(t.type,t.__selected_input_source)[2],expanded:""},on:{input:e.update},model:{value:t[t.__selected_input_source||"name"],callback:function(i){e.$set(t,t.__selected_input_source||"name",i)},expression:"item[item.__selected_input_source || 'name']"}})],1)],1),i("b-field",[i("b-input",{attrs:{type:"text",placeholder:"Texte alternatif (requis)",icon:"eye-off",required:""},on:{input:e.update},model:{value:t.alt,callback:function(i){e.$set(t,"alt",i)},expression:"item.alt"}})],1),i("b-field",[i("b-input",{attrs:{type:"text",placeholder:"Légende (facultatif)",icon:"image-text","icon-right":"language-markdown"},on:{input:e.update},model:{value:t.caption,callback:function(i){e.$set(t,"caption",i)},expression:"item.caption"}})],1),i("b-field",[i("b-input",{attrs:{type:"text",placeholder:"Copyright",icon:"copyright","icon-right":"language-markdown"},on:{input:e.update},model:{value:t.copyright,callback:function(i){e.$set(t,"copyright",i)},expression:"item.copyright"}})],1),"answer"!==e.path?i("b-field",[i("b-switch",{on:{input:e.update},model:{value:t.hide_copyright,callback:function(i){e.$set(t,"hide_copyright",i)},expression:"item.hide_copyright"}},[e._v(" Masquer le copyright pendant la question"),i("br"),i("small",[e._v("À utiliser si le copyright révèle la réponse. Le copyright sera affiché avec la réponse.")])])],1):e._e()]],2):e._e(),i("div",{staticClass:"media-right"},[i("a",{attrs:{title:"Supprimer"},on:{click:function(t){return e.removeItemConfirmation(n,t)}}},[i("b-icon",{attrs:{icon:"delete"}})],1)])])})),e.preview?e._e():i("footer",[i("div",{staticClass:"button-with-icon"},[i("b-icon",{attrs:{icon:"plus",size:"is-medium"}}),i("span",[e._v("Ajouter")])],1),i("button",{staticClass:"button-with-icon",on:{click:function(t){return e.addItem("text")}}},[i("b-icon",{attrs:{icon:"text",size:"is-medium"}}),i("span",[e._v("Texte")])],1),i("button",{staticClass:"button-with-icon",on:{click:function(t){return e.addItem("quote")}}},[i("b-icon",{attrs:{icon:"format-quote-close",size:"is-medium"}}),i("span",[e._v("Citation")])],1),i("button",{staticClass:"button-with-icon",on:{click:function(t){return e.addItem("picture")}}},[i("b-icon",{attrs:{icon:"image",size:"is-medium"}}),i("span",[e._v("Image")])],1),i("button",{staticClass:"button-with-icon",on:{click:function(t){return e.addItem("movie")}}},[i("b-icon",{attrs:{icon:"movie",size:"is-medium"}}),i("span",[e._v("Vidéo")])],1),i("button",{staticClass:"button-with-icon",on:{click:function(t){return e.addItem("sound")}}},[i("b-icon",{attrs:{icon:"headphones",size:"is-medium"}}),i("span",[e._v("Son")])],1)])],2)}),g=[],w=i("b85c"),_=i("d4cd"),q=i.n(_),x=q()({breaks:!0,linkify:!0,typographer:!0,quotes:["« "," »","‹ "," ›"]}),C={props:{uuid:String,path:String},computed:Object(c["a"])(Object(c["a"])({},Object(u["d"])(["preview"])),{},{content:function(){return this.$store.state.file[this.uuid][this.path].content}}),methods:Object(c["a"])(Object(c["a"])({},Object(u["b"])(["updateQuestion"])),{},{itemInputTypes:function(e){switch(e){case"movie":return[["name","Fichier","URL ou nom du fichier"],["youtube","YouTube","URL vers une vidéo YouTube"],["dailymotion","Dailymotion","URL vers une vidéo Dailymotion"],["vimeo","Vimeo","URL vers une vidéo Vimeo"]];case"sound":return[["name","Fichier","URL ou nom du fichier"],["soundcloud","SoundCloud","URL vers un enregistrement SoundCloud"],["spotify","Spotify","Lien vers un morceau sur Spotify"]]}},itemInputType:function(e,t){var i,n=Object(w["a"])(this.itemInputTypes(e));try{for(n.s();!(i=n.n()).done;){var s=i.value;if(s[0]===t)return s}}catch(o){n.e(o)}finally{n.f()}},addItem:function(e){switch(e){case"text":this.content.push({type:"text",text:""});break;case"quote":this.content.push({type:"quote",text:"",author:""});break;case"picture":this.content.push({type:"picture",name:"",alt:"",caption:"",copyright:"",hide_copyright:!1,__selected_input_source:"name"});break;case"movie":this.content.push({type:"movie",name:"",youtube:null,dailymotion:null,vimeo:null,alt:"",caption:"",copyright:"",hide_copyright:!1,__selected_input_source:"name"});break;case"sound":this.content.push({type:"sound",name:"",soundcloud:null,spotify:null,alt:"",caption:"",copyright:"",hide_copyright:!1,__selected_input_source:"name"});break}this.update()},removeItemConfirmation:function(e,t){var i=this;t.ctrlKey?this.removeItem(e):this.$buefy.dialog.confirm({title:"Supprimer cet élément ?",message:"<small>Astuce : cliquer le bouton de suppression en pressant Ctrl supprime directement l'élément sans confirmation.</small>",type:"is-danger",confirmText:"Supprimer cet élément",cancelText:"Annuler",ariaRole:"dialog",ariaModal:!0,onConfirm:function(){return i.removeItem(e)}})},removeItem:function(e){this.content.splice(e,1),this.update()},update:function(){var e=this.$store.state.file[this.uuid];e[this.path].content=this.content,this.updateQuestion({uuid:this.uuid,question:e})},addPrivateAttributes:function(){var e,t=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)&&void 0!==e[t]&&null!==e[t]&&""!==e[t]},i=Object(w["a"])(this.content);try{for(i.s();!(e=i.n()).done;){var n=e.value;t(n,"__selected_input_source")||"movie"!==n.type&&"sound"!==n.type||this.$set(n,"__selected_input_source",t(n,"name")?"name":t(n,"youtube")?"youtube":t(n,"dailymotion")?"dailymotion":t(n,"vimeo")?"vimeo":t(n,"soundcloud")?"soundcloud":t(n,"spotify")?"spotify":"name")}}catch(s){i.e(s)}finally{i.f()}this.update()},md:function(e){return x.render(e)},mdInline:function(e){return x.renderInline(e)}}),mounted:function(){this.addPrivateAttributes()},watch:{content:function(){this.addPrivateAttributes()}}},k=C,O=(i("d8ef"),Object(d["a"])(k,y,g,!1,null,null,null)),j=O.exports,$={components:{QuestionContent:j},data:function(){return{known_categories_filtered:[]}},computed:Object(c["a"])(Object(c["a"])({},Object(u["d"])({current_uuid:function(e){return e.current},question:function(e){return e.file[e.current]},known_categories:function(e){return Object(b["a"])(new Set(Object.values(e.file).map((function(e){return e.categories})).flat()))},preview:function(e){return e.preview},answersVisible:function(e){return e.answers}})),{},{sources:{get:function(){return this.question.answer.sources.join("\n")},set:function(e){this.question.answer.sources=e.split("\n"),this.update()}}}),methods:Object(c["a"])(Object(c["a"])({},Object(u["b"])(["newQuestion","updateQuestion","deleteQuestion","previewSourceURLs"])),{},{filterKnownCategories:function(e){this.known_categories_filtered=this.known_categories.filter((function(t){return t.toLowerCase().indexOf(e.toLowerCase())>=0}))},update:function(){this.updateQuestion({uuid:this.current_uuid,question:this.question})},focusLastQCMOption:function(){var e=this;this.$refs.answerOptions&&this.$nextTick((function(){var t=e.$refs.answerOptions.querySelectorAll("input[type=text]");t&&t[t.length-1].focus()}))},addQCMOption:function(){this.question.answer.options||this.$set(this.question.answer,"options",[]),this.question.answer.options.push({answer:"",valid:!1,__removable:!0}),this.update(),this.focusLastQCMOption()},deleteQCMOptionIfEmpty:function(e,t){this.question.answer.options&&this.question.answer.options[e]&&(this.question.answer.options[e].answer?this.question.answer.options[e].__removable=!1:this.question.answer.options[e].__removable&&this.question.answer.options.length>1?(this.deleteQCMOption(e),this.focusLastQCMOption()):this.question.answer.options[e].__removable=!0)},deleteQCMOptionConfirmation:function(e,t){var i=this;t.ctrlKey?this.deleteQCMOption(e):this.$buefy.dialog.confirm({title:"Supprimer cette question ?",message:"Vous supprimez l'option de réponse «&nbsp;<strong>".concat(this.question.answer.options[e].answer,"</strong>&nbsp;».<br /><br />\n        <small>Astuce : cliquer le bouton de suppression en pressant Ctrl supprime directement la question sans confirmation.</small>"),type:"is-danger",confirmText:"Supprimer cette option",cancelText:"Annuler",ariaRole:"dialog",ariaModal:!0,onConfirm:function(){return i.deleteQCMOption(e)}})},deleteQCMOption:function(e){this.question.answer.options.splice(e,1),this.update()},deleteQuestionConfirmation:function(e){var t=this;e.ctrlKey?this.deleteQuestion(this.current_uuid):this.$buefy.dialog.confirm({title:"Supprimer cette question ?",message:"Vous supprimez la question «&nbsp;<strong>".concat(this.question.question.text,"</strong>&nbsp;».<br /><br />\n        <small>Astuce : cliquer le bouton de suppression en pressant Ctrl supprime directement la question sans confirmation.</small>"),type:"is-danger",confirmText:"Supprimer cette question",cancelText:"Annuler",ariaRole:"dialog",ariaModal:!0,onConfirm:function(){return t.deleteQuestion(t.current_uuid)}})},md:function(e){return x.render(e)},mdInline:function(e){return x.renderInline(e)}}),watch:{question:function(){var e=this;this.question.answer.options||this.$set(this.question.answer,"options",[]),this.$nextTick((function(){e.question&&e.$refs.questionInput&&e.$refs.questionInput.focus()}))}}},I=$,Q=(i("d25c"),Object(d["a"])(I,v,h,!1,null,null,null)),S=Q.exports,L=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("nav",[i("header",[i("h2",[e._v(e._s(Object.keys(e.file).length)+" question"+e._s(Object.keys(e.file).length>1?"s":""))]),i("b-button",{attrs:{type:e.search?"is-primary":"is-link",size:"is-small",rounded:"","icon-left":"magnify"},on:{click:function(t){e.search=!e.search}}}),i("b-button",{attrs:{type:"is-primary",size:"is-small",rounded:"","icon-left":"plus",title:"Ctrl + E"},on:{click:e.newQuestion}},[e._v("Question")])],1),i("header",{directives:[{name:"show",rawName:"v-show",value:e.search,expression:"search"}],staticClass:"search"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.search_term,expression:"search_term"}],ref:"searchField",attrs:{type:"text",placeholder:"Rechercher…"},domProps:{value:e.search_term},on:{keyup:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"]))return null;e.search=!1},input:function(t){t.target.composing||(e.search_term=t.target.value)}}})]),i("ul",{staticClass:"questions-list"},e._l(e.questions,(function(t,n){return i("li",{key:n,class:{"is-active":n===e.current},attrs:{title:t.question.text||"Question vide"},on:{click:function(t){return e.selectQuestion(n)}}},[i("h3",{class:{"is-empty":!t.question.text},domProps:{innerHTML:e._s(e.mdInline(t.question.text||"Question vide"))}}),i("ul",{staticClass:"meta"},[i("li",["text"===t.answer.type?i("b-icon",{attrs:{size:"is-small",icon:"lead-pencil",title:"Texte"}}):"qcm"===t.answer.type?i("b-icon",{attrs:{size:"is-small",icon:"format-list-bulleted-square",title:"QCM"}}):"geo"===t.answer.type?i("b-icon",{attrs:{size:"is-small",icon:"map",title:"Carte"}}):"drawing"===t.answer.type?i("b-icon",{attrs:{size:"is-small",icon:"draw",title:"Dessin"}}):i("span",[e._v(e._s(t.answer.type))])],1),t.categories.length>0?i("li",[e._v(e._s(t.categories[0]))]):e._e(),t.nsfw?i("li",[e._v("NSFW")]):e._e(),t.question.text&&(0===t.categories.length||"text"===t.answer.type&&!t.answer.answer||"qcm"===t.answer.type&&(!t.answer.options||t.answer.options.length<2))?i("li",{attrs:{title:"Un ou plusieurs éléments manquent (catégories ou réponses)."}},[i("b-icon",{attrs:{size:"is-small",icon:"alert-circle"}})],1):e._e(),t.question.text&&0===t.answer.sources.length&&0===t.answer.content.length?i("li",{attrs:{title:"Cette question n'a ni explications, ni sources."}},[i("b-icon",{attrs:{size:"is-small",icon:"school"}})],1):e._e()])])})),0)])},P=[],z=i("3835"),F=(i("841c"),i("c1f9"),i("4fadc"),{data:function(){return{search:!1,search_term:""}},computed:Object(c["a"])(Object(c["a"])({},Object(u["d"])(["file","current"])),{},{questions:function(){if(!this.search)return this.file;var e=this.search_term.toLowerCase();return Object.fromEntries(Object.entries(this.file).filter((function(t){var i=Object(z["a"])(t,2),n=(i[0],i[1]);if(-1!==n.question.text.toLowerCase().indexOf(e))return!0;var s,o=Object(w["a"])(n.categories);try{for(o.s();!(s=o.n()).done;){var r=s.value;if(-1!==r.toLowerCase().indexOf(e))return!0}}catch(x){o.e(x)}finally{o.f()}if(n.answer.answer&&-1!==n.answer.answer.toLowerCase().indexOf(e))return!0;for(var a=0,c=Object.values(n.answer.options||{});a<c.length;a++){var u=c[a];if(-1!==u.answer.toLowerCase().indexOf(e))return!0}var l,p=Object(w["a"])(n.answer.sources);try{for(p.s();!(l=p.n()).done;){var d=l.value;if(-1!==d.toLowerCase().indexOf(e))return!0}}catch(x){p.e(x)}finally{p.f()}for(var m=0,f=["question","answer"];m<f.length;m++){var v,h=f[m],b=Object(w["a"])(n[h].content);try{for(b.s();!(v=b.n()).done;)for(var y=v.value,g=0,_=["text","alt","caption","copyright"];g<_.length;g++){var q=_[g];if(Object.prototype.hasOwnProperty.call(y,q)&&-1!==y[q].toLowerCase().indexOf(e))return!0}}catch(x){b.e(x)}finally{b.f()}}return!1})))}}),methods:Object(c["a"])(Object(c["a"])(Object(c["a"])({},Object(u["c"])(["selectQuestion"])),Object(u["b"])(["newQuestion"])),{},{mdInline:function(e){return x.renderInline(e)}}),watch:{search:function(){var e=this;this.search&&this.$refs.searchField&&this.$nextTick((function(){return e.$refs.searchField.focus()}))}}}),M=F,R=(i("0fcd"),Object(d["a"])(M,L,P,!1,null,null,null)),T=R.exports,E=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("b-modal",{model:{value:e.validation.displayed,callback:function(t){e.$set(e.validation,"displayed",t)},expression:"validation.displayed"}},[i("div",{staticClass:"modal-card",staticStyle:{width:"auto"}},[i("header",{staticClass:"modal-card-head"},["export"===e.validation.why?i("p",{staticClass:"modal-card-title"},[e._v("Le fichier exporté contient des erreurs")]):i("p",{staticClass:"modal-card-title"},[e._v("Impossible d'importer ces questions")])]),i("section",{staticClass:"modal-card-body"},["export"===e.validation.why?i("p",[e._v(" Le fichier a été exporté avec succès, mais il pourrait ne pas correctement fonctionner. Les erreurs sont listées ci-dessous. ")]):i("p",[e._v(" Il n'a pas été possible d'importer ces questions car le format n'est pas respecté. Veuillez vérifier le format et réessayer. Les erreurs sont listées ci-dessous. ")]),i("hr"),e._l(e.groupedErrors,(function(t,n,s){return i("dl",{key:s},[i("dt",[i("span",{domProps:{innerHTML:e._s(e.mdInline(e.questionFromUUID(n)))}}),i("small",[e._v(e._s(n))])]),i("dd",e._l(t,(function(t,n){return i("ul",{key:n},[i("li",[e._v(e._s(t.stack))])])})),0)])}))],2),i("footer",{staticClass:"modal-card-foot"},[e.validation.result&&e.validation.result.errors?i("p",[e._v(" "+e._s(e.validation.result.errors.length)+" erreur"+e._s(e.validation.result.errors.length>1?"s":"")+". ")]):e._e(),i("b-button",{on:{click:function(t){e.validation.displayed=!1}}},[e._v("Fermer")])],1)])])},A=[],N=(i("5319"),{computed:Object(c["a"])(Object(c["a"])({},Object(u["d"])(["file","validation"])),{},{groupedErrors:function(){return this.validation.result&&this.validation.result.errors?this.validation.result.errors.reduce((function(e,t){return e[t.path[0]]=e[t.path[0]]||[],t.stack=t.stack.replace("instance.".concat(t.path[0],"."),"").replace('instance["'.concat(t.path[0],'"].'),"").replace("undefined.".concat(t.path[0],"."),"").replace('undefined["'.concat(t.path[0],'"].'),""),e[t.path[0]].push(t),e}),Object.create(null)):{}}}),methods:{questionFromUUID:function(e){return this.file[e].question.text},mdInline:function(e){return x.renderInline(e)}}}),U=N,D=(i("3861"),Object(d["a"])(U,E,A,!1,null,"0ba1be8a",null)),V=D.exports,J=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("b-modal",{model:{value:e.importing,callback:function(t){e.importing=t},expression:"importing"}},[i("div",{staticClass:"modal-card",staticStyle:{width:"auto"}},[i("header",{staticClass:"modal-card-head"},[i("p",{staticClass:"modal-card-title"},[e._v("Importer des questions")])]),e.result.finished?i("section",{staticClass:"modal-card-body"},[i("p",[i("strong",[e._v("Les fichiers valides ont été importés avec succès.")])]),i("p",[e._v(e._s(e.result.imported)+" questions importées (dont "+e._s(e.result.duplicated)+" dupliquée(s)), et "+e._s(e.result.ignored)+" question(s) ignorées car la question existait déjà.")]),e.result.invalid.length>0?i("p",{staticClass:"is-invalid-files"},[e._v("Ces fichiers n'ont pas été importés car ils étaient invalides (pas du JSON, JSON invalide, ou JSON ne correspondant pas au schéma) : "+e._s(e.result.invalid.join(", ")))]):e._e()]):i("section",{staticClass:"modal-card-body"},[i("div",{staticClass:"columns"},[i("div",{staticClass:"column"},[i("b-field",[i("b-upload",{attrs:{multiple:"","drag-drop":"",expanded:"",accept:"application/json"},model:{value:e.importedFiles,callback:function(t){e.importedFiles=t},expression:"importedFiles"}},[i("section",{staticClass:"section"},[i("div",{staticClass:"content has-text-centered"},[i("p",[i("b-icon",{attrs:{icon:"upload",size:"is-large"}})],1),i("p",[e._v("Glissez ici les fichiers à importer, ou cliquez pour les envoyer")])])])])],1),i("aside",{staticClass:"import-previews"},e._l(e.importedFilesPreviews,(function(t,n,s){return i("div",{key:s,staticClass:"import-preview",class:{"is-invalid":!Number.isInteger(t)}},[i("p",{staticClass:"is-name"},[e._v(e._s(n))]),Number.isInteger(t)?i("p",{staticClass:"is-status"},[e._v(e._s(t)+" question"+e._s(t>1?"s":""))]):"bad-type"===t?i("p",{staticClass:"is-status"},[e._v("Mauvais type (JSON requis)")]):"invalid"===t?i("p",{staticClass:"is-status"},[e._v("Format invalide")]):"unparsable"===t?i("p",{staticClass:"is-status"},[e._v("Fichier illisible (JSON invalide)")]):e._e(),i("button",{staticClass:"delete is-small",attrs:{type:"button",title:"Ne pas importer ce fichier"},on:{click:function(t){return e.deleteFileImport(n)}}})])})),0)],1),i("div",{staticClass:"column"},[i("b-field",{staticClass:"has-vertical-radios",attrs:{label:"En cas de conflit…",message:"Il y a conflit si une question importée a le même identifiant unique (UUID) qu'une question existante. Cela se produit lorsque vous importez des questions précédemment exportées. Évitez de regénérer cette identifiant pour les questions utilisées en production, car cela réinitialise la difficulté calculée."}},[i("b-radio",{attrs:{"native-value":"overwrite"},model:{value:e.conflictsResolution,callback:function(t){e.conflictsResolution=t},expression:"conflictsResolution"}},[e._v(" Remplacer la question existante par la nouvelle ")]),i("b-radio",{attrs:{"native-value":"keep"},model:{value:e.conflictsResolution,callback:function(t){e.conflictsResolution=t},expression:"conflictsResolution"}},[e._v(" Conserver la question existante, et ne pas importer la nouvelle ")]),i("b-radio",{attrs:{"native-value":"duplicate"},model:{value:e.conflictsResolution,callback:function(t){e.conflictsResolution=t},expression:"conflictsResolution"}},[e._v(" Conserver les deux questions (la question importée aura un identifiant unique regénéré) ")])],1)],1)])]),i("footer",{staticClass:"modal-card-foot"},[i("p"),e.result.finished?e._e():i("b-button",{attrs:{type:"is-primary",disabled:!e.canImport||e.result.importing,loading:e.result.importing},on:{click:e.doImport}},[e._v("Importer")]),i("b-button",{attrs:{disabled:e.result.importing},on:{click:function(t){return e.closeImport()}}},[e._v("Fermer")])],1)])])},H=[],W=(i("8ba4"),i("a9e3"),i("b64b"),i("c740"),i("b0c0"),i("caad"),i("2532"),i("ec26")),B=i("1da1"),K=(i("96cf"),i("e9c4"),i("99af"),i("498a"),i("2ca0"),i("2b3d"),i("9861"),i("8a79"),i("5b81"),i("21a6")),G=i("a41b"),Y=i("3a27"),X=i("acedc"),Z=i("89ca");n["a"].use(u["a"]);var ee={wikis:[["wikipedia.org","Wikipédia"],["wiktionary.org","le Wiktionnaire"],["wikisource.org","Wikisource"],["fandom.com","Fandom"]],keys:{linkpreview:["80e33552c26cf554050170dad63e7c4a","9d63dfa47c62906c037ad943a6a7b509"]}};function te(e){localStorage.setItem("cdc-file",JSON.stringify(e.file))}function ie(e){for(var t in e)e[t]=ne(e[t]);return e}function ne(e){return e.duration=parseInt(e.duration),isNaN(e.duration)&&(e.duration=null),e}function se(e){return(new G["Validator"]).validate(e,Z,{nestedErrors:!0,throwError:!1})}var oe=new u["a"].Store({state:{file:{},current:void 0,preview:!1,answers:!0,validation:{result:null,why:null,displayed:!1},importing:!1},mutations:{load:function(e,t){e.file=t},selectQuestion:function(e,t){e.current=t},unselectQuestion:function(e){e.current=void 0},newQuestion:function(e){var t=Object(W["a"])(),i={lang:"fr",nsfw:!1,categories:[],duration:void 0,question:{text:"",content:[]},answer:{type:"qcm",answer:"",options:[{answer:"",valid:!1,__removable:!0}],as_text:!0,content:[],sources:[]}};n["a"].set(e.file,t,i),e.current=t},updateQuestion:function(e,t){var i=t.uuid,s=t.question;n["a"].set(e.file,i,s)},deleteQuestion:function(e,t){n["a"].delete(e.file,t),e.current=void 0},togglePreview:function(e,t){e.preview=t},toggleAnswersVisible:function(e){e.answers=!e.answers},setSchemaValidation:function(e,t){e.validation=t},importing:function(e,t){e.importing=t}},actions:{loadFromBrowser:function(e){var t=localStorage.getItem("cdc-file");if(t)try{e.commit("load",JSON.parse(t))}catch(i){console.error("Unable to load file from local storage: JSON parsing error (did you tamper with the data?).",i),console.info("Raw data in the local storage:"),console.info(t)}},newQuestion:function(e){e.commit("newQuestion"),te(e.state)},updateQuestion:function(e,t){var i=t.uuid,n=t.question;e.commit("updateQuestion",{uuid:i,question:ne(n)}),te(e.state)},deleteQuestion:function(e,t){e.commit("deleteQuestion",t),te(e.state)},backup:function(e){var t=e.state;return new Promise((function(e,i){localStorage.setItem("cdc-file-backup-".concat(Date.now()),JSON.stringify(t.file)),e()}))},previewSourceURLs:function(e,t){var i=e.state,s=e.dispatch,o=t?[t]:Object.keys(i.file),r=[],a=0,c=[];function u(e){return l.apply(this,arguments)}function l(){return l=Object(B["a"])(regeneratorRuntime.mark((function e(t){var o,r,u,l,p,d,m,f,v,h,b,y,g,_,q;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:o=i.file[t],r=!1,e.t0=regeneratorRuntime.keys(o.answer.sources);case 3:if((e.t1=e.t0()).done){e.next=49;break}if(u=e.t1.value,l=o.answer.sources[u].trim().split(" "),p=l[0],p.startsWith("http://")||p.startsWith("https://")){e.next=9;break}return e.abrupt("continue",3);case 9:d=new URL(p),m=null,f=null,v=null,h=Object(w["a"])(ee.wikis),e.prev=14,h.s();case 16:if((b=h.n()).done){e.next=27;break}if(y=b.value,!d.hostname.toLowerCase().endsWith(y[0])){e.next=25;break}return g=d.pathname.split("/"),m=decodeURI(g[g.length-1]).replaceAll("_"," "),f=y[1],v=d.hash?decodeURI(d.hash.substr(1)).replaceAll("_"," "):null,r=!0,e.abrupt("break",27);case 25:e.next=16;break;case 27:e.next=32;break;case 29:e.prev=29,e.t2=e["catch"](14),h.e(e.t2);case 32:return e.prev=32,h.f(),e.finish(32);case 35:if(null!==m){e.next=46;break}return e.next=38,fetch("https://api.linkpreview.net",{method:"POST",mode:"cors",body:JSON.stringify({key:ee.keys.linkpreview[Math.floor(Math.random()*ee.keys.linkpreview.length)],q:p})}).catch((function(e){return console.log(e),c.push(e)}));case 38:if(_=e.sent,_.ok){e.next=42;break}return c.push(_),e.abrupt("continue",3);case 42:return e.next=44,_.json();case 44:q=e.sent,m=q.title;case 46:null!=m&&(l[0]="[_".concat(m,"_](").concat(p,")")+(f?", sur ".concat(f):"")+(v?", section _".concat(v,"_"):""),n["a"].set(o.answer.sources,u,l.join(" ")),a+=1),e.next=3;break;case 49:return r&&s("updateQuestion",{uuid:t,question:o}),e.abrupt("return",!0);case 51:case"end":return e.stop()}}),e,null,[[14,29,32,35]])}))),l.apply(this,arguments)}var p,d=Object(w["a"])(o);try{for(d.s();!(p=d.n()).done;){var m=p.value;r.push(u(m))}}catch(f){d.e(f)}finally{d.f()}Promise.all(r).then((function(e){X["a"].open({message:"<strong>Toutes les sources ont été prévisualisées.</strong><br /><small>Prévisualisés : ".concat(a," — Erreurs : ").concat(c.length,' — Certaines adresses ont pu être prévisualisées grâce à <a href="https://www.linkpreview.net">LinkPreview</a>.</small>'),type:"is-light",duration:6e3}),c.length>0&&console.log("Errors while previewing:",c)}))},validateQuestions:function(e,t){var i=e.state,n=e.commit,s=t.file,o=t.why;return new Promise((function(e,t){var r=se(s||i.file);r.valid?(n("setSchemaValidation",{result:r,why:o,displayed:!1}),e(r)):(n("setSchemaValidation",{result:r,why:o,displayed:!0}),t(r))}))},fixFile:function(e){var t=e.state,i=e.commit;return new Promise((function(e,n){var s=ie(t.file);i("load",s),e()}))},exportQuestions:function(e){var t=e.state,i=e.dispatch;i("fixFile").then((function(){var e=Object(Y["a"])(t.file),n=new Blob([JSON.stringify(e)],{type:"application/json;charset=utf-8"});Object(K["saveAs"])(n,"questions.json"),i("validateQuestions",{why:"export"}).catch((function(){}))}))}},modules:{}}),re={data:function(){return{importedFiles:[],importedFilesPreviews:{},conflictsResolution:"overwrite",result:{finished:!1,importing:!1,imported:0,duplicated:0,ignored:0,invalid:[]}}},computed:Object(c["a"])(Object(c["a"])({},Object(u["d"])({getImporting:function(e){return e.importing},existingFile:function(e){return e.file}})),{},{importing:{get:function(){return this.getImporting},set:function(e){this.setImporting(e)}},canImport:function(){return this.importedFiles.length>0&&Object.values(this.importedFilesPreviews).some((function(e){return Number.isInteger(e)}))},existingUUIDs:function(){return Object.keys(this.existingFile)}}),methods:Object(c["a"])(Object(c["a"])(Object(c["a"])({},Object(u["c"])({setImporting:"importing",addQuestion:"updateQuestion"})),Object(u["b"])(["backup"])),{},{deleteFileImport:function(e){Object.prototype.hasOwnProperty.call(this.importedFilesPreviews,e)&&delete this.importedFilesPreviews[e];var t=this.importedFiles.findIndex((function(t){return t.name===e}));this.importedFiles.splice(t,1)},doImport:function(){var e=this;this.backup().then((function(){e.result.importing=!0;var t,i=[],n=Object(w["a"])(e.importedFiles);try{var s=function(){var n=t.value;if("application/json"!==n.type)return"continue";i.push(n.text().then((function(t){try{var i=JSON.parse(t);if(se(i).valid)for(var s in i)e.existingUUIDs.includes(s)&&"overwrite"!==e.conflictsResolution?"duplicate"===e.conflictsResolution?(e.addQuestion({uuid:Object(W["a"])(),question:i[s]}),e.result.imported++,e.result.duplicated++):e.result.ignored++:(e.addQuestion({uuid:s,question:i[s]}),e.result.imported++);else e.result.invalid.push(n.name)}catch(o){e.result.invalid.push(n.name)}})))};for(n.s();!(t=n.n()).done;)s()}catch(o){n.e(o)}finally{n.f()}Promise.all(i).then((function(){e.result.importing=!1,e.result.finished=!0}))}))},closeImport:function(){this.importing=!1,this.result={finished:!1,importing:!1,imported:0,duplicated:0,ignored:0,invalid:[]},this.importedFiles=[],this.importedFilesPreviews={}}}),watch:{importedFiles:function(){var e,t=this,i=Object(w["a"])(this.importedFiles);try{var n=function(){var i=e.value;if(!Object.prototype.hasOwnProperty.call(t.importedFilesPreviews,i.name)){if("application/json"!==i.type)return t.$set(t.importedFilesPreviews,i.name,"bad-type"),"continue";i.text().then((function(e){try{var n=JSON.parse(e);se(n).valid?t.$set(t.importedFilesPreviews,i.name,Object.keys(n).length):t.$set(t.importedFilesPreviews,i.name,"invalid")}catch(s){t.$set(t.importedFilesPreviews,i.name,"unparsable")}}))}};for(i.s();!(e=i.n()).done;)n()}catch(s){i.e(s)}finally{i.f()}}}},ae=re,ce=(i("6f98"),Object(d["a"])(ae,J,H,!1,null,null,null)),ue=ce.exports,le={name:"App",components:{Header:f,QuestionsList:T,QuestionDetails:S,ValidationModal:V,ImportModal:ue},methods:Object(u["b"])(["loadFromBrowser","newQuestion"]),computed:Object(u["d"])({is_question_displayed:function(e){return!!e.current}}),mounted:function(){this.$nextTick(this.loadFromBrowser),this._keyListener=function(e){"e"===e.key&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),this.newQuestion())},document.addEventListener("keydown",this._keyListener.bind(this))},beforeDestroy:function(){document.removeEventListener("keydown",this._keyListener)}},pe=le,de=(i("cf25"),Object(d["a"])(pe,s,o,!1,null,null,null)),me=de.exports,fe=i("9483");Object(fe["a"])("".concat("/editeur-de-champignons/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var ve=i("77b4"),he=i("ff69"),be=i("39ea"),ye=i("ea9e"),ge=i("10bd"),we=i("7f82"),_e=i("c0ac"),qe=i("61b7"),xe=i("8cbf"),Ce=i("2183"),ke=i("544d"),Oe=i("6e24"),je=i("80f1"),$e=i("f723"),Ie=i("f7da");i("73e4");[ve["a"],he["a"],be["a"],ye["a"],ge["a"],we["a"],_e["a"],qe["a"],xe["a"],Ce["a"],ke["a"],Oe["a"],je["a"],$e["a"],X["b"],Ie["a"]].forEach((function(e){return n["a"].use(e)})),n["a"].config.productionTip=!1,new n["a"]({store:oe,render:function(e){return e(me)}}).$mount("#app")},"6f98":function(e,t,i){"use strict";i("baa5")},"73e4":function(e,t,i){},"89ca":function(e){e.exports=JSON.parse('{"$schema":"https://json-schema.org/draft/2020-12/schema","$id":"https://shroom.morel.games/questions-catalog.schema.json","title":"Questions catalog","description":"A set of questions that can be used for Shroom-compatible games","type":"object","properties":{},"patternProperties":{"^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89ABab][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$":{"type":"object","properties":{"lang":{"type":"string"},"categories":{"type":"array","items":{"type":"string"},"uniqueItems":true},"duration":{"anyOf":[{"type":"integer","minimum":0},{"type":"null"}]},"question":{"type":"object","properties":{"text":{"type":"string"},"content":{"$ref":"#/$defs/content"}},"required":["text"]},"answer":{"type":"object","oneOf":[{"$ref":"#/$defs/answerText"},{"$ref":"#/$defs/answerChoices"},{"$ref":"#/$defs/answerDrawing"},{"$ref":"#/$defs/answerGeo"}]},"nsfw":{"type":"boolean"}},"required":["lang","categories","question","answer"]}},"additionalProperties":false,"$defs":{"content":{"type":"array","items":{"type":"object","oneOf":[{"$ref":"#/$defs/contentText"},{"$ref":"#/$defs/contentQuote"},{"$ref":"#/$defs/contentPicture"},{"$ref":"#/$defs/contentMovie"},{"$ref":"#/$defs/contentSound"}]}},"contentText":{"type":"object","properties":{"type":{"enum":["text"]},"text":{"type":"string"}},"required":["type","text"]},"contentQuote":{"type":"object","properties":{"type":{"enum":["quote"]},"text":{"type":"string"},"author":{"type":"string"}},"required":["type","text"]},"contentMediaCommon":{"type":"object","properties":{"name":{"anyOf":[{"type":"string"},{"type":"null"}]},"alt":{"type":"string"},"caption":{"type":"string"},"copyright":{"type":"string"},"hide_copyright":{"type":"boolean"}},"required":["alt"]},"contentPicture":{"type":"object","allOf":[{"$ref":"#/$defs/contentMediaCommon"}],"properties":{"type":{"enum":["picture"]}},"required":["type","name"]},"contentMovie":{"type":"object","allOf":[{"$ref":"#/$defs/contentMediaCommon"}],"properties":{"type":{"enum":["movie"]},"youtube":{"anyOf":[{"type":"string"},{"type":"null"}]},"dailymotion":{"anyOf":[{"type":"string"},{"type":"null"}]},"vimeo":{"anyOf":[{"type":"string"},{"type":"null"}]}},"required":["type"]},"contentSound":{"type":"object","allOf":[{"$ref":"#/$defs/contentMediaCommon"}],"properties":{"type":{"enum":["sound"]},"soundcloud":{"anyOf":[{"type":"string"},{"type":"null"}]},"spotify":{"anyOf":[{"type":"string"},{"type":"null"}]}},"required":["type"]},"answerCommon":{"type":"object","properties":{"content":{"$ref":"#/$defs/content"},"sources":{"type":"array","items":{"type":"string"}}}},"answerText":{"type":"object","allOf":[{"$ref":"#/$defs/answerCommon"}],"properties":{"type":{"enum":["text"]},"answer":{"type":"string"}},"required":["type","answer"]},"answerChoices":{"type":"object","allOf":[{"$ref":"#/$defs/answerCommon"}],"properties":{"type":{"enum":["qcm"]},"options":{"type":"array","items":{"type":"object","properties":{"answer":{"type":"string"},"valid":{"type":"boolean"}},"required":["answer"]}},"as_text":{"type":"boolean"}},"required":["type","options"]},"answerDrawing":{"type":"object","allOf":[{"$ref":"#/$defs/answerCommon"}],"properties":{"type":{"enum":["drawing"]}},"required":["type"]},"answerGeo":{"type":"object","allOf":[{"$ref":"#/$defs/answerCommon"}],"properties":{"type":{"enum":["geo"]}},"required":["type"]}}}')},"94ab":function(e,t,i){"use strict";i("c4d8")},baa5:function(e,t,i){},c4d8:function(e,t,i){},cf25:function(e,t,i){"use strict";i("fea6")},d25c:function(e,t,i){"use strict";i("2b7e")},d8ef:function(e,t,i){"use strict";i("f572")},e5ea:function(e,t,i){},f572:function(e,t,i){},fea6:function(e,t,i){}});
//# sourceMappingURL=app.d739dbbc.js.map